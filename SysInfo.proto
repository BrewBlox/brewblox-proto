syntax = "proto3";

import "brewblox.proto";
import "nanopb.proto";

package blox;

message SysInfo {
  option (brewblox_msg).objtype = SysInfo;
  enum Platform {
    unknown_platform = 0;
    gcc = 3;
    photon = 6;
    p1 = 8;
  }

  bytes deviceId = 1 [
    (brewblox).readonly = true,
    (nanopb).max_size = 12,
    (nanopb).fixed_length = true,
    (brewblox).hexstr = true
  ];
  string version = 2 [ (brewblox).readonly = true, (nanopb).max_size = 12 ];
  Platform platform = 3 [ (brewblox).readonly = true ];

  string protocolVersion = 7
      [ (brewblox).readonly = true, (nanopb).max_size = 12 ];
  string releaseDate = 8 [ (brewblox).readonly = true, (nanopb).max_size = 12 ];
  string protocolDate = 9
      [ (brewblox).readonly = true, (nanopb).max_size = 12 ];

  enum Command {
    NONE = 0;
    READ_TRACE = 1;
  }

  message Trace {
    enum Action {
      NONE = 0;
      SEND_OBJECT = 1;
      RECEIVE_OBJECT = 2;
      PERSIST_OBJECT = 3;
      UPDATE_OBJECT = 4;
    }
    Action action = 1;
    uint32 id = 2 [ (nanopb).int_size = IS_16 ];
    uint32 type = 3 [ (nanopb).int_size = IS_16 ];
  }

  Command command = 10;
  repeated Trace trace = 11 [ (nanopb).max_count = 10 ];
}
